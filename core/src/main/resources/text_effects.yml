version: 1

# Text effect GLSL snippets used when generating text shaders.
# Each effect defines:
# - id: numeric effect id (0-7)
# - enabled: whether the effect is available
# - color: hex color for the effect (e.g. "#FF5500")
# - speed: animation speed (1-7, default 3)
# - param: effect parameter like amplitude/intensity (0-7, default 3)
# - description: optional text shown in /oraxen texteffects
# - snippets: GLSL code for the effect
#
# Usage in chat: <effect:wave>wavy text</effect>
#
# The color, speed, and param are baked into the shader at pack generation.
# This means each effect has a fixed appearance - no per-message customization.
# This tradeoff eliminates false positives where gradient colors triggered effects.

shared:
  # Shared GLSL helpers inserted before main() in fragment shaders.
  fragment_prelude: |
    // HSV to RGB conversion for rainbow effect
    vec3 hsv2rgb(vec3 c) {
        vec4 K = vec4(1.0, 2.0/3.0, 1.0/3.0, 3.0);
        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
    }

effects:
  rainbow:
    id: 0
    enabled: true
    speed: 3
    description: Cycles through rainbow colors over time
    snippets:
      - fragment: |
          float hue = fract(charIndex * 0.03 + timeSeconds * EFFECT_SPEED * 0.03);
          vec3 rgb = hsv2rgb(vec3(hue, 0.9, 1.0));
          texColor.rgb = rgb;

  wave:
    id: 1
    enabled: true
    color: "#55CDFC"
    speed: 3
    param: 4
    description: Vertical sine wave motion
    snippets:
      - fragment: |
          texColor.rgb = EFFECT_COLOR;
      - vertex: |
          float phase = charIndex * 0.6 + timeSeconds * EFFECT_SPEED * 2.0;
          float amplitude = EFFECT_PARAM * 0.5;
          pos.y += sin(phase) * amplitude;

  shake:
    id: 2
    enabled: true
    color: "#FF6B6B"
    speed: 4
    param: 3
    description: Random jitter
    snippets:
      - fragment: |
          texColor.rgb = EFFECT_COLOR;
      - vertex: |
          float seed = charIndex + floor(timeSeconds * EFFECT_SPEED * 8.0);
          float amplitude = EFFECT_PARAM * 0.5;
          pos.x += (fract(sin(seed * 12.9898) * 43758.5453) - 0.5) * amplitude;
          pos.y += (fract(sin(seed * 78.233) * 43758.5453) - 0.5) * amplitude;

  pulse:
    id: 3
    enabled: true
    color: "#FFD93D"
    speed: 3
    description: Opacity fades in/out
    snippets:
      - fragment: |
          texColor.rgb = EFFECT_COLOR;
          float pulse = (sin(timeSeconds * EFFECT_SPEED * 0.5 + charIndex * 0.3) + 1.0) * 0.5;
          texColor.a *= 0.3 + pulse * 0.7;
