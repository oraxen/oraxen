version: 1

# Text effect GLSL snippets used when generating text shaders.
# Each effect defines:
# - id: numeric effect id encoded into RGB low bits (see TextEffects.shader.encoding)
# - enabled: whether the effect is available
# - description: optional text shown in /oraxen texteffects
# - snippets: ordered list of GLSL snippets (first matching target wins)
#   - targets: optional constraints for pack format or minecraft version
#   - vertex: GLSL lines inserted in the vertex shader main() for this effect
#   - fragment: GLSL lines inserted in the fragment shader main() for this effect
#
# Available variables inside snippets:
# - float timeSeconds, speed, param, charIndex
# - vec3 pos (vertex) or vec4 texColor (fragment)
# - int effectType (already decoded)
#
# Snippet target constraints (all optional):
#   targets:
#     min_pack_format: 34
#     max_pack_format: 46
#     min_version: "1.21"
#     max_version: "1.21.5"

shared:
  # Shared GLSL helpers inserted before main() in fragment shaders.
  fragment_prelude: |
    // HSV to RGB conversion for rainbow effect
    vec3 hsv2rgb(vec3 c) {
        vec4 K = vec4(1.0, 2.0/3.0, 1.0/3.0, 3.0);
        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
    }

effects:
  rainbow:
    id: 0
    enabled: true
    description: Cycles through rainbow colors over time
    snippets:
      - fragment: |
          float hue = fract(charIndex * 0.03 + timeSeconds * speed * 0.03);
          vec3 rgb = hsv2rgb(vec3(hue, 0.9, 1.0));
          texColor.rgb = rgb;

  wave:
    id: 1
    enabled: true
    description: Vertical sine wave motion
    snippets:
      - vertex: |
          float phase = charIndex * 0.6 + timeSeconds * speed * 2.0;
          float amplitude = max(1.0, param) * 0.15;
          pos.y += sin(phase) * amplitude;

  shake:
    id: 2
    enabled: true
    description: Random jitter
    snippets:
      - vertex: |
          float seed = charIndex + floor(timeSeconds * speed * 8.0);
          float amplitude = max(1.0, param) * 0.15;
          pos.x += (fract(sin(seed * 12.9898) * 43758.5453) - 0.5) * amplitude;
          pos.y += (fract(sin(seed * 78.233) * 43758.5453) - 0.5) * amplitude;

  pulse:
    id: 3
    enabled: true
    description: Opacity fades in/out
    snippets:
      - fragment: |
          float pulse = (sin(timeSeconds * speed * 0.5 + charIndex * 0.3) + 1.0) * 0.5;
          texColor.a *= 0.3 + pulse * 0.7;

  gradient:
    id: 4
    enabled: true
    description: Static color gradient
    snippets:
      - fragment: |
          float t = charIndex / 15.0;
          vec3 startColor = vec3(1.0, 0.3, 0.3);
          vec3 endColor = vec3(0.3, 0.3, 1.0);
          texColor.rgb = mix(startColor, endColor, t);

  typewriter:
    id: 5
    enabled: true
    description: Characters appear sequentially left-to-right
    snippets:
      - fragment: |
          float reveal = mod(timeSeconds * speed * 2.0, 256.0);
          float alpha = clamp(reveal - charIndex, 0.0, 1.0);
          texColor.a *= alpha;
